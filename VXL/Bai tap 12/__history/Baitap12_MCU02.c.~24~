# INCLUDE <16F887.H>
# DEVICE ADC = 10
# FUSES HS
# USE DELAY (CLOCK = 20M)
# USE RS232 (BAUD = 9600, XMIT = PIN_C6, RCV = PIN_C7)

# DEFINE LCD_ENABLE_PIN    PIN_E2
# DEFINE LCD_RS_PIN        PIN_E0
# DEFINE LCD_RW_PIN        PIN_E1
# DEFINE LCD_DATA4         PIN_D4
# DEFINE LCD_DATA5         PIN_D5
# DEFINE LCD_DATA6         PIN_D6
# DEFINE LCD_DATA7         PIN_D7
# INCLUDE <LCD.C>

UNSIGNED INT16 ND1, ND2;

#INT_TIMER1
VOID RECIEVE_DATA ()
{
   ND1 = GETC();
   LCD_GOTOXY (1,2);
   PRINTF (LCD_PUTC, "TEMP1 = %2LU C", ND1);
   SET_TIMER1 (-62500);
   LCD_GOTOXY (11,2);
   LCD_PUTC (0XDF);
   DELAY_MS (10);
}

VOID MAIN ()
{
   SET_TRIS_B (0X00);
   SET_TRIS_D (0X00);
   SET_TRIS_E (0X00);
   SET_TRIS_A (0XFF);
   
   ENABLE_INTERRUPTS (GLOBAL);
   ENABLE_INTERRUPTS (INT_TIMER1);
   SETUP_TIMER_1 (T1_INTERNAL|T1_DIV_BY_8);
   SET_TIMER1 (-1);
   LCD_INIT();
   SETUP_ADC(ADC_CLOCK_DIV_2);
   SETUP_ADC_PORTS(SAN0|VSS_VDD);
//!   SET_ADC_CHANNEL (0);
//!   DELAY_MS (10);
   WHILE (TRUE)
   {
      SET_ADC_CHANNEL (0);
      DELAY_MS (10);
      ND2 = READ_ADC () / 2.046;
      LCD_GOTOXY (1,1);
      PRINTF (LCD_PUTC, "TEMP2 = %2LU C", ND2);
      LCD_GOTOXY (11,1);
      LCD_PUTC (0XDF);
      DELAY_MS (10);
   }
}
