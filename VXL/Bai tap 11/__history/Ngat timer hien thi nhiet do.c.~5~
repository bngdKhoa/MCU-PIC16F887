# INCLUDE <16F887.H>
# DEVICE ADC = 10 
# FUSES HS 
# USE DELAY (CLOCK = 20M)
CONST UNSIGNED MA7DOAN [10] = {0XC0, 0XF9, 0XA4, 0XB0, 0X99, 0X92, 0X82, 0X82, 0X80, 0X90};
UNSIGNED INT16 TEMP;
UNSIGNED INT8 DLHT_8L7D [8] = { 0XFF, 0XFF, 0XFF, 0XFF, 0XFF, 0XFF, 0X9C, 0XC6};
VOID HIENTHI_8L7DQ ()
{
   UNSIGNED INT8 I, QUET;
   QUET = 0XFE;
   FOR (I = 0; I < 8; I++)
   {
      OUTPUT_D (QUET);
      OUTPUT_C (DLHT_8L7D [I]);
      DELAY_US (300);
      OUTPUT_C (0XFF);
      QUET = (QUET << 1) + 1;
   }
}

# INT_TIMER1 
VOID NGAT_TIMER_QUETLED ()
{
   SET_TIMER1 (-5000);
   HIENTHI_8L7DQ ();
}
VOID MAIN ()
{
   SET_TRIS_D (0X00);
   SET_TRIS_C (0X00);
   ENABLE_INTERRUPTS(GLOBAL);
   ENABLE_INTERRUPTS (INT_TIMER1);
   SETUP_ADC (ADC_CLOCK_INTERNAL);
   SETUP_ADC_PORTS (SAN5|VSS_VDD);
   SET_ADC_CHANNEL (5);
   DELAY_MS (10);
   WHILE (TRUE)
   {
      TEMP = READ_ADC ();
      TEMP = TEMP / 2.046;
      DLHT_8L7D [5] = MA7DOAN [TEMP % 10];
      DLHT_8L7D [4] = MA7DOAN [TEMP / 10];
      DELAY_MS (1000);
   }
}

